The Linear Mixed Model (LMM) Approach 
model <- lmer (TOVA_score ~ Time * spindle_density + age + sex + (1 | ID), data = df_long) 
lmer is the function in “R” but I can figure out what it is in Python if you’d prefer to do it there.  

 Data Structure: Long Format (each row is one timepoint per child):
ID	Time	TOVA_score	spindle_density	age	sex
01	PM	250	2.3	9	M
01	AM	265	2.3	9	M
02	PM	200	3.1	10	F
02	AM	195	3.1	10	F
Here’s what each piece means:
•	TOVA_score: outcome variable (we will model each separately: d-prime, RT variability, omission errors, commission errors)
•	Time: categorical variable with two levels — "PM" (before sleep) and "AM" (after sleep)
•	spindle_density: does not vary across time for the same subject (this is a between-subject predictor)
We’re asking: "Do kids with more spindles show a greater within-person change in performance over time?"
This output will tell you:
1.	Main effect of Time: is TOVA performance better in the morning than the evening (i.e., evidence of learning)?
2.	Main effect of spindle_density: do kids with more spindles perform better overall?
3.	Time × spindle_density interaction: do kids with more spindles improve more overnight?
The interaction is the key test:
•	If it’s significant, that suggests overnight learning depends on spindle activity.
•	If not, then kids may improve over time regardless of their spindle profile.
So, If the interaction term is positive and significant: Kids with higher spindle density show greater improvement from PM to AM on the TOVA task — suggesting sleep-dependent learning.
The Role of Time
•	Time is NOT the predictor of PM score
•	Time is a within-subject variable indicating when the score was measured (before vs after sleep)
•	the model is looking at how spindles interact with Time to predict TOVA changes across the night
Another way we could look at the data: 
Linear Model (this is basically an ANCOVA) 
LM(TOVA_AM ~ TOVA_PM + spindle_density + age + sex)
this model uses wide format data (Each row represents one subject, with separate columns for TOVA_AM and TOVA_PM)
A single outcome: AM score
PM score is treated as a covariate (adjusting for baseline)
We’re essentially asking:
"Given their baseline PM score, do spindle features explain higher-than-expected AM performance?"
Conceptual Difference
The AM ~ PM ANCOVA model:
•	Models between-subject differences: among kids with similar PM scores, who has a better AM score?
•	Emphasizes post-sleep outcome
•	Can be thought of as modeling residualized change (i.e., how much more did a child gain than expected from their baseline)
The LMM (Time × Spindle):
•	Models within-subject change over time
•	Explicitly tests whether the slope of improvement (PM → AM) is steeper for kids with more spindles
•	Directly uses the longitudinal structure of the data

 When Is Each Better?
Use Model 1 (AM ~ PM) if:
•	You only care about AM outcomes
•	You want to adjust for baseline but not explicitly model change
•	You are working with complete cases only (e.g. not using missing data)
•	You need a simple linear regression for quick interpretation
Use Model 2 (LMM) if:
•	You want to test the hypothesis that sleep-related change depends on spindle activity
•	You want to include all available data, even partially missing data
•	You want to separate within-subject vs. between-subject variance
•	You expect some kids will show no change or worsening, and want to model that variability

Criterion	Model 1: AM ~ PM (ANCOVA)	Model 2: LMM (Time × Spindle)
Controls for baseline	Yes, directly with PM covariate	Yes, implicitly via within-subject modeling
 Estimates individual change	Indirectly (residualized gain)	Directly (models time effect per subject)
 Uses all available data	No – needs both AM and PM	Yes – partial data allowed
Adjusts for regression to the mean	Yes	Yes
 Statistical power (given missingness)	Lower	Higher
 Ease of interpretation	Very intuitive	Slightly more complex
 Sensitivity to outliers in PM score	High	Lower
 Ideal if only interested in AM outcome	Yes	No – LMM better if change is the focus

